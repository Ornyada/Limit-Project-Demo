<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <!--<meta http-equiv="X-UA-Compatible" content="IE=Edge" /> หากคุณไม่ได้รองรับ IE หรือใช้ Edge/Chrome/Firefox เป็นหลัก คุณสามารถ ลบ meta tag นี้ออกได้เลย-->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Contoso Task Pane Add-in</title>

  <!-- Fluent UI -->
  <link rel="stylesheet"
    href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css" />

  <!-- Template styles -->
  <link href="taskpane.css" rel="stylesheet" type="text/css" />
</head>

<body class="ms-font-m ms-welcome ms-Fabric">
  <header class="ms-welcome__header ms-bgColor-neutralLighter">
    <img width="210" height="50" src="../../assets/NXPblack" alt="Contoso" title="Contoso" />
    <h1 class="ms-font-su">Welcome to Limit Tool</h1>
    <h2 class="ms-font-xl">by Ornyada Charunyanont</h2>
  </header>

  <section id="sideload-msg" class="ms-welcome__main">
    <h2 class="ms-font-xl">
      Please <a target="_blank" rel="noopener noreferrer"
        href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a>
      your add-in to see app body.
    </h2>
  </section>

  <main id="app-body" class="ms-welcome__main">

    <!-- 1. Import testtable folder -->
    <div class="feature-box">
      <div class="feature-row">
        <span class="ms-font-m"><b>1. Import testtable folder</b></span>
        <div class="folder-upload-container">
          <label for="folderInput">Testtable =></label>
          <input type="file" id="folderInput" webkitdirectory multiple />
          <button type="button" id="importFolderBtn">Import Folder</button>
        </div>
      </div>
    </div>

    <!-- 2. Choose .mfh file -->
    <div class="feature-box">
      <div class="feature-row">
        <span class="ms-font-m"><b>2. Choose .mfh file</b></span>
        <div class="mfh-list">
          <h3>Select a .mfh file to process:</h3>
          <ul id="mfh-list"></ul>
        </div>
      </div>
    </div>

    <!-- 3. Import datalog files -->
    <div class="feature-box">
      <div class="feature-row">
        <span class="ms-font-m"><b>3. Import datalog files (.stdf/.xlsx)</b></span>
        <div class="file-upload-container">
          <label for="fileInput">Datalog Files =></label>
          <input type="file" id="fileInput" multiple />
          <button type="button" id="importDatalogBtn">Import File</button>
        </div>
      </div>
    </div>

    <!-- Run button -->
    <div class="feature-box">
      <div class="feature-row">
        <p class="ms-font-l">Create the Masterfile! click...Run</p>
        <div role="button" id="run" class="ms-welcome__action ms-Button ms-Button--hero ms-font-xl">
          <span class="ms-Button-label"><b>Run</b></span>
        </div>
      </div>
    </div>

      <div class="stages-compare">
        <!--stages checkbox-->
        <div class="stages-checkbox" id = "checkboxForm">
          <p class = "select-header"><b>Select to Show :</b></p>
          <div id="labelList"></div> <!-- ใส่ checkbox ไว้ในนี้ -->
          <!--start each limit compare button-->
          <div class="compare-button-group">
            <div role="button" id="compare" class="compare-button">
              <span><b>Show</b></span>
            </div>
            <div role="button" id="compareAll" class="compare-button">
              <span><b>Select all</b></span>
              </div>
          </div>
        </div>
      </div>

    <p><label id="item-subject"></label></p>
    <div id="download-links"></div>
    <div id="consoleOutput">
      <div>Console :</div>
    </div>
  </main>



  <!-- ✅ โหลด office.js ก่อน -->
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

  <!-- ✅ โหลด SheetJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

  <!-- ✅ ตัวอย่างลิงก์ดาวน์โหลด 
  <script>
    const fileName = "example.txt";
    const container = document.getElementById("download-links");
    const link = document.createElement("a");
    link.href = `https://127.0.0.1:8000/download/${fileName}`;
    link.target = "_blank";
    link.rel = "noopener";
    link.textContent = "Download File";
    container.appendChild(link);
  </script>
</body>-->

</body>
</html>